\section{Постановка задачи}
Даны пять распределений:
\begin{itemize}
\item Нормальное распределение: $N(x, 0, 1)$
\item Распределение Коши: $C(x, 0, 1)$
\item Распределение Лапласа: $L(x, 0, \frac{1}{\sqrt{2}})$
\item Распределение Пуассона: $P(k, 10)$
\item Равномерное распределение: $U(x, -\sqrt{3}, \sqrt{3})$
\end{itemize}

Для каждого распределения требуется сгенерировать выборки из 20 и 100 элементов.

Построить для них боксплот Тьюки.

Для каждого распределения требуется:
\begin{itemize}
	\item Определить долю выбросов, сгенерировав выборку, соответствующую распределению, 1000 раз и вычислив среднюю долю выбросов
	\item Сравнить с результатами, полученными теоретически
\end{itemize}

\section{Теория}

\section{Боксплот Тьюки}
Самым простым средством, использующимся для визуального анализа статистических данных, является гистограмма. Однако она не всегда является удобной: по общему виду диаграммы зачастую бывает трудно понять, какими параметрами положения и рассеяния обладает исследуемое распределение.

В связи с этим было разработано такое средство визуализации распределения, как \textit{боксплот Тьюки} -- это прямоугольник, вертикальные границы которого соответствуют нижнему и верхнему квартилям. Внутри него отображается вертикальная линия, соответствующая медиане. Также из этого ``ящика'' выходят усы, сонаправленные абсциссе. Их крайние точки соответствуют точкам, отстоящим от соответствующих квартилей на полтора межквартильных расстояния:
\begin{equation}
	X_1 = Q_1 - \frac{3}{2}(Q_3-Q_1)
\end{equation}

\begin{equation}
	X_2 = Q_3 + \frac{3}{2}(Q_3-Q_1)
\end{equation}

Они характеризуют меру рассеяния данных. Все данные, которые оказались за пределами усов, можно считать статистическими выбросами. Их отображают с помощью кружочков. Таким образом, мы можем легко оценить степень разброса и асимметрии данных.

По ординате боксплот можно располагать, например, таким образом, чтобы его средняя линия соответствовала количеству элементов, из которых составлена данная выборка. Можно также располагать несколько боксплотов друг над другом, чтобы визуально сравнивать полученные параметры распределений.

\section{Вычисление вероятности выбросов}

Выбросами считаются величины, удовлетворяющие условию:


\begin{equation}
\left[
\begin{array}{c}
x < X_1 \\
x > X_2
\end{array}
\right.
\end{equation}

Для теоретических распределений эту величину можно получить аналитически:

\begin{equation}\label{trashdata}
P_{\text{в}}^{\text{Т}}=P(x<X_1 | x > X_2) = F_X(X_1) + 1 - F_X(X_2)
\end{equation}

где $F_X$ -- функция распределения.

Для экспериментальных -- непосредственным вычислением: итерируясь по всем элементам сгенерированного распределения, увеличивать счётчик выбросов в соответствующем случае. В конце поделить полученное количество выбросов на общее число элементов в выборке.
	
\section{Реализация}
Данная работа реализована на языке программирования Python с использованием IDE PyCharm и библиотек NumPy, MatPlotLib в ОС Ubuntu 19.04.

Отчёт подготовлен с помощью компилятора pdflatex и среды разработки TeXStudio.

\section{Результаты}
\subsection{Боксплот}
Ниже представлены таблицы полученных характеристик положения заданных распределений и характеристик рассеяния для совокупности 1000 проведённых экспериментов

\begin{figure}[H]
	\begin{center}
		\includegraphics[scale=0.5]{Normal_boxplot}
		\caption{Нормальное распределение}
		\label{pic:pic_name}
	\end{center}
\end{figure}


\begin{figure}[H]
	\begin{center}
		\includegraphics[scale=0.5]{Cauchy_boxplot}
		\caption{Распределение Коши}
		\label{pic:pic_name}
	\end{center}
\end{figure}


\begin{figure}[H]
	\begin{center}
		\includegraphics[scale=0.5]{Laplace_boxplot}
		\caption{Распределение Лапласа}
		\label{pic:pic_name}
	\end{center}
\end{figure}

\begin{figure}[H]
	\begin{center}
		\includegraphics[scale=0.5]{Poisson_boxplot}
		\caption{Распределение Пуассона}
		\label{pic:pic_name}
	\end{center}
\end{figure}

\begin{figure}[H]
	\begin{center}
		\includegraphics[scale=0.5]{Uniform_boxplot}
		\caption{Равномерное распределение}
		\label{pic:pic_name}
	\end{center}
\end{figure}

\subsection{Экспериментальная доля выбросов}

\begin{table}[H]
	\begin{center}
		\input{table/trashdata.tex}
		\caption{Экспериментальная доля выбросов}
		\label{tabl:tabl_name}
	\end{center}
\end{table}


\subsection{Теоретическая доля выбросов}

\begin{table}[H]
	\begin{center}
		\begin{tabular}{|c|c|}
			\hline			
			Распределение & $P_{\text{в}}^{\text{Т}}$ (\ref{trashdata})
			\\
			\hline			
			Normal & 0.007 \\
			\hline
			Cauchy & 0.156 \\
			\hline
			Laplace & 0.063 \\
			\hline			
			Poisson & 0.008 \\
			\hline		
			Uniform & 0 \\
			\hline			
		\end{tabular}
		\caption{Теоретическая доля выбросов}
		\label{tabl:tabl_name}
	\end{center}
\end{table}

\section{Обсуждение}

Во всех распределениях, кроме распределения Коши, можно отметить, что выборочное среднее и выборочная медиана располагаются друг другу ближе (в смысле модуля разности), чем к другим характеристикам. Также видно, что эти параметры положения являются наиболее стабильными: во всех распределениях, кроме распределения Коши, они обладают минимальной дисперсией по сравнению с другими характеристиками. Более того, вычисленные в разных экспериментах значения медианы распределения Коши также оказывались минимально разбросанными, из чего можно сделать вывод, что данную характеристику можно рекомендовать как лучший среди представленных параметров положения -- он показывает стабильный результат даже на таком специфичном распределении, как распределение Коши.

Аномальное поведение данных в распределении Коши, судя по всему, связано с отсутствием у него матожидания (в том смысле, что интеграл, позволяющий его посчитать, расходится).

Хочется отметить полусумму экстремальных значений как наименее стабильный параметр положения: его дисперсия всегда была в разы, а иногда и на несколько порядков, выше, чем у других характеристик. Оно и понятно: мы используем весьма специфичные и уникальные для каждого эксперимента точки -- выбросы распределения -- как опорные элементы для вычисления параметра положения, что, вообще говоря, нелогично.

Все остальные характеристики положения показывали достаточно схожие результаты и их стабильность.

Сравним характеристики для выборок из 1000 элементов по величине:
\begin{itemize}
	\item Нормальное распределение
	
	$\overline{x} \leq z_{tr} \leq med{x} \leq z_Q \leq z_R $
	
	\item Распределение Коши
	
	$z_R \leq \overline{x} \leq med{x} \leq z_{tr} \leq z_Q $
	
	\item Распределение Лапласа
	
	$ \overline{x} \leq z_{tr} \leq med{x} \leq z_Q \leq z_R $
	
	\item Распределение Пуассона
	
	$ z_{tr} \leq med{x} \leq z_Q \leq \overline{x} \leq z_R $
	
	\item Равномерное распределение
	
	$ z_R \leq z_{tr} \leq \overline{x} \leq med{X} \leq z_Q $
	
\end{itemize}

\section{Литература}
Максимов Ю. Д. Математическая статистика //СПб.: СПбГПУ. – 2004.

\section{Приложения}

Репозиторий с кодом программы и кодом отчёта: \href{https://github.com/kystyn/stats}{https://github.com/kystyn/stats}



