\section{Постановка задачи}
Даны пять распределений:
\begin{itemize}
\item Нормальное распределение: $N(x, 0, 1)$
\item Распределение Коши: $C(x, 0, 1)$
\item Распределение Лапласа: $L(x, 0, \frac{1}{\sqrt{2}})$
\item Распределение Пуассона: $P(k, 10)$
\item Равномерное распределение: $U(x, -\sqrt{3}, \sqrt{3})$
\end{itemize}

Для каждого распределения требуется сгенерировать выборки из 20 и 100 элементов.

Построить для них боксплот Тьюки.

Для каждого распределения требуется:
\begin{itemize}
	\item Определить долю выбросов, сгенерировав выборку, соответствующую распределению, 1000 раз и вычислив среднюю долю выбросов
	\item Сравнить с результатами, полученными теоретически
\end{itemize}

\section{Теория}

\section{Боксплот Тьюки}
Самым простым средством, использующимся для визуального анализа статистических данных, является гистограмма. Однако она не всегда является удобной: по общему виду диаграммы зачастую бывает трудно понять, какими параметрами положения и рассеяния обладает исследуемое распределение.

В связи с этим было разработано такое средство визуализации распределения, как \textit{боксплот Тьюки} -- это прямоугольник, вертикальные границы которого соответствуют нижнему и верхнему квартилям. Внутри него отображается вертикальная линия, соответствующая медиане. Также из этого ``ящика'' выходят ``усы'', сонаправленные абсциссе. Их концы соответствуют точкам, отстоящим от соответствующих квартилей на полтора межквартильных расстояния:
\begin{equation}
	X_1 = Q_1 - \frac{3}{2}(Q_3-Q_1)
\end{equation}

\begin{equation}
	X_2 = Q_3 + \frac{3}{2}(Q_3-Q_1)
\end{equation}

Они характеризуют меру рассеяния данных. Все данные, которые оказались за пределами усов, можно считать статистическими выбросами. Их отображают с помощью кружочков. Таким образом, мы можем легко оценить степень разброса и асимметрии данных.

По ординате боксплот можно располагать, например, таким образом, чтобы его средняя линия соответствовала количеству элементов, из которых составлена данная выборка. Можно также располагать несколько боксплотов друг над другом, чтобы визуально сравнивать полученные параметры распределений.

\begin{figure}[H]
	\begin{center}
		\includegraphics[scale=0.3]{example_boxplot}
		\caption{Пример боксплота (\ref{bplotex})}
		\label{pic:pic_name}	
	\end{center}
\end{figure}

\section{Вычисление вероятности выбросов}

Выбросами считаются величины, удовлетворяющие условию:


\begin{equation}
\left[
\begin{array}{c}
x < X_1 \\
x > X_2
\end{array}
\right.
\end{equation}

Для теоретических распределений эту величину можно получить аналитически:

\begin{equation}\label{trashdata}
P_{\text{в}}^{\text{Т}}=P(x<X_1 | x > X_2) = F_X(X_1) + 1 - F_X(X_2)
\end{equation}

где $F_X$ -- функция распределения.

Для экспериментальных -- непосредственным вычислением: итерируясь по всем элементам сгенерированного распределения, увеличивать счётчик выбросов в соответствующем случае. В конце поделить полученное количество выбросов на общее число элементов в выборке.
	
\section{Реализация}
Данная работа реализована на языке программирования Python с использованием IDE PyCharm и библиотек NumPy, MatPlotLib в ОС Ubuntu 19.04.

Отчёт подготовлен с помощью компилятора pdflatex и среды разработки TeXStudio.

\section{Результаты}
\subsection{Боксплот}
Ниже представлены таблицы полученных характеристик положения заданных распределений и характеристик рассеяния для совокупности 1000 проведённых экспериментов

\begin{figure}[H]
	\begin{center}
		\includegraphics[scale=0.5]{Normal_boxplot}
		\caption{Нормальное распределение}
		\label{pic:pic_name}
	\end{center}
\end{figure}


\begin{figure}[H]
	\begin{center}
		\includegraphics[scale=0.5]{Cauchy_boxplot}
		\caption{Распределение Коши}
		\label{pic:pic_name}
	\end{center}
\end{figure}


\begin{figure}[H]
	\begin{center}
		\includegraphics[scale=0.5]{Laplace_boxplot}
		\caption{Распределение Лапласа}
		\label{pic:pic_name}
	\end{center}
\end{figure}

\begin{figure}[H]
	\begin{center}
		\includegraphics[scale=0.7]{Poisson_boxplot}
		\caption{Распределение Пуассона}
		\label{pic:pic_name}
	\end{center}
\end{figure}

\begin{figure}[H]
	\begin{center}
		\includegraphics[scale=0.7]{Uniform_boxplot}
		\caption{Равномерное распределение}
		\label{pic:pic_name}
	\end{center}
\end{figure}

\subsection{Экспериментальная доля выбросов}

\begin{table}[H]
	\begin{center}
		\input{table/trashdata.tex}
		\caption{Экспериментальная доля выбросов}
		\label{tabl:tabl_name}
	\end{center}
\end{table}


\subsection{Теоретическая вероятность выбросов}

\begin{table}[H]
	\begin{center}
		\begin{tabular}{|c|c|}
			\hline			
			Распределение & $P_{\text{в}}^{\text{Т}}$ (\ref{trashdata})
			\\
			\hline			
			Normal & 0.007 \\
			\hline
			Cauchy & 0.156 \\
			\hline
			Laplace & 0.063 \\
			\hline			
			Poisson & 0.008 \\
			\hline		
			Uniform & 0 \\
			\hline			
		\end{tabular}
		\caption{Теоретическая доля выбросов}
		\label{tabl:tabl_name}
	\end{center}
\end{table}

\section{Обсуждение}

Боксплоты Тьюки действительно позволяют более наглядно и с меньшими усилиями оценивать важные характеристики распределений. Так, исходя из полученных рисунков, наглядно видно то, что мы довольно трудоёмко анализировали в предыдущих частях: чем больше количество элементов в сгенерированной выборке, тем сильнее медиана и интерквартальный размах приближаются к теоретическим значениям. Также хорошо видно, что нормальное распределение является в высшей степени симметричным, даже на выборке в 20 значений. Мы видим, что распределение Коши имеет много выбросов, находящихся на значительном удалении (расстояние от медианы до выброса в десятки раз выше интерквартального размаха) от медианы -- в этом смысле данное распределение предпочительно использовать при генерации случайных чисел.

Стоит также отметить, что у всех распределений медиана смещена относительно середины межквартильного интервала. 

Вспомним предыдущие результаты: ранее было получено, что медиана среди прочих характеристик максимально приближена к выборочному среднему, которое в свою очередь сходится почти наверное к матожиданию (при его наличии) [2]. То есть медиана является очень состоятельной оценкой теоретического среднего. Этот факт позволяет нам лишний раз убедиться, что полусумма квартилей не является достаточно качественной оценкой среднего.

Что касается теоретической и экспериментальной доли выбросов: здесь мы видим, что экспериментальная доля выбросов оказывается тем точнее приближена к теоретической вероятности выбросов, чем больше элементов в выборке. В таблице снова видно, что доля выбросов в распределении Коши значительно превосходит долю выбросов в других распределениях.

\section{Литература}
[1] Максимов Ю. Д. Математическая статистика //СПб.: СПбГПУ. – 2004.

[2] \href{https://ru.wikipedia.org/wiki/%D0%92%D1%8B%D0%B1%D0%BE%D1%80%D0%BE%D1%87%D0%BD%D0%BE%D0%B5_%D1%81%D1%80%D0%B5%D0%B4%D0%BD%D0%B5%D0%B5}{Википедия: выборочное среднее}

\section{Приложения}

\begin{enumerate}
	\item Репозиторий с кодом программы и кодом отчёта: \href{https://github.com/kystyn/stats}{https://github.com/kystyn/stats}

	\item \href{https://towardsdatascience.com/understanding-boxplots-5e2df7bcbd51}{Ссылка на пример боксплота}\label{bplotex}
\end{enumerate}


